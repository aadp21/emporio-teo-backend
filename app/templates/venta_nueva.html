{% extends "base.html" %}

{% block title %}Registrar Venta - Emporio Teo{% endblock %}

{% block content %}

<h1 class="mb-4">Registrar Venta ({{ fecha }})</h1>

<form method="post" action="/panel/ventas/nueva" class="row g-3 mb-4">

  <div class="col-md-4">
    <label class="form-label">Total (CLP)</label>
    <input type="number"
           step="0.01"
           min="1"
           required
           name="total"
           class="form-control">
  </div>

  <div class="col-md-4">
    <label class="form-label">Tipo de Pago</label>
    <select name="tipo_pago" class="form-select" required>
      <option value="Efectivo">Efectivo</option>
      <option value="Débito">Débito</option>
      <option value="Crédito">Crédito</option>
      <option value="Transferencia">Transferencia</option>
      <option value="Personal">Personal</option>
    </select>
  </div>

  <div class="col-12">
    <button class="btn btn-primary btn-sm">Guardar venta</button>
    <a href="/panel/ventas?fecha={{ fecha }}" class="btn btn-secondary btn-sm ms-2">Ir a listado</a>
  </div>

</form>

<div class="mb-3">
  <strong>Total vendido hoy:</strong>
  {{ "{:,.0f}".format(total_dia) }} CLP
</div>

<table class="table table-striped table-hover align-middle">
  <thead class="table-dark">
    <tr>
      <th>ID</th>
      <th>Hora</th>
      <th>Total</th>
      <th>Tipo de pago</th>
      <th>Creado</th>
    </tr>
  </thead>
  <tbody>
    {% for v in ventas %}
    <tr>
      <td>{{ v.id }}</td>
      <td>
        {% if v.hora %}
          {{ v.hora.strftime('%H:%M:%S') }}
        {% endif %}
      </td>
      <td>{{ "{:,.0f}".format(v.total) }}</td>
      <td>{{ v.tipo_pago }}</td>
      <td>
        {% if v.created_at %}
          {{ v.created_at.strftime('%Y-%m-%d %H:%M') }}
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
